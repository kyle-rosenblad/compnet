<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Network models of interspecific competition with presence-absence data — buildcompnet • compnet</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Network models of interspecific competition with presence-absence data — buildcompnet"><meta name="description" content="Network models of interspecific competition with presence-absence data"><meta property="og:description" content="Network models of interspecific competition with presence-absence data"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">compnet</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/compnet_workflow.html">The 'compnet' workflow</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Network models of interspecific competition with presence-absence data</h1>

      <div class="d-none name"><code>buildcompnet.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Network models of interspecific competition with presence-absence data</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">buildcompnet</span><span class="op">(</span></span>
<span>  <span class="va">presabs</span>,</span>
<span>  spvars_no_int <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  spvars_dist_int <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  spvars_multi_int <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  spvars_cat_no_int <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  spvars_cat_int <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pairvars <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  rank <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  family <span class="op">=</span> <span class="st">"fnchypg"</span>,</span>
<span>  olre <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  prior_intercept_scale <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  prior_betas_scale <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  prior_sigma_addeff_rate <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  prior_sigma_olre_rate <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  prior_lambda_scale <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  warmup <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  iter <span class="op">=</span> <span class="fl">2000</span>,</span>
<span>  adapt_delta <span class="op">=</span> <span class="fl">0.8</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-presabs">presabs<a class="anchor" aria-label="anchor" href="#arg-presabs"></a></dt>
<dd><p>Must be specified by user. Binary (0 or 1) presence-absence matrix with sites as
rows and species as columns. Column names should be unique species names.</p></dd>


<dt id="arg-spvars-no-int">spvars_no_int<a class="anchor" aria-label="anchor" href="#arg-spvars-no-int"></a></dt>
<dd><p>A matrix or data frame, in which rows are species and columns are traits to
be included in the model as additive species effects only, with no interaction term. Row names
should be unique species names, and column names should be unique trait names.</p></dd>


<dt id="arg-spvars-dist-int">spvars_dist_int<a class="anchor" aria-label="anchor" href="#arg-spvars-dist-int"></a></dt>
<dd><p>A matrix or data frame, in which rows are species and columns are traits
to be included in the model with a distance interaction term (i.e., the absolute value of the
difference in trait values for each species pair). Row names should be unique species names,
and column names should be unique trait names.</p></dd>


<dt id="arg-spvars-multi-int">spvars_multi_int<a class="anchor" aria-label="anchor" href="#arg-spvars-multi-int"></a></dt>
<dd><p>A matrix or data frame, in which rows are species and columns are traits
to be included in the model with a multiplicative interaction term (i.e., the product of the
trait values for each species pair). Row names should be unique species names, and column
names should be unique trait names.</p></dd>


<dt id="arg-spvars-cat-no-int">spvars_cat_no_int<a class="anchor" aria-label="anchor" href="#arg-spvars-cat-no-int"></a></dt>
<dd><p>A matrix or data frame, in which rows are species and columns are categorical traits to
be included in the model as additive species effects only, with no interaction term. Row names
should be unique species names, and column names should be unique trait names.</p></dd>


<dt id="arg-spvars-cat-int">spvars_cat_int<a class="anchor" aria-label="anchor" href="#arg-spvars-cat-int"></a></dt>
<dd><p>A matrix or data frame, in which rows are species and columns are categorical traits to
be included in the model with a binary "same or different" interaction term. Row names
should be unique species names, and column names should be unique trait names.</p></dd>


<dt id="arg-pairvars">pairvars<a class="anchor" aria-label="anchor" href="#arg-pairvars"></a></dt>
<dd><p>A matrix or data frame, in which rows are species pairs and columns are
pair-level traits that do not have a species-level analog, e.g., phylogenetic distance.
Column names should be unique trait names. There
should also be two columns named "spAid" and "spBid" containing the unique names of the
species in each pair.</p></dd>


<dt id="arg-rank">rank<a class="anchor" aria-label="anchor" href="#arg-rank"></a></dt>
<dd><p>Number of dimensions for the multiplicative latent factor term. Rank=0 (the default)
yields a model with no multiplicative term.</p></dd>


<dt id="arg-family">family<a class="anchor" aria-label="anchor" href="#arg-family"></a></dt>
<dd><p>Distribution family for regression model. Defaults to 'fnchypg', or Fisher's noncentral
hypergeometric distribution. In this case, the quantity we are modeling, as a function of species
traits, dyadic random effects, etc. is Mainali et al.'s (2022, Science Advances) "alpha" or "cooccurrence affinity"
parameter in the fnchypg distribution. Link function is identity. 'binomial', also supported, is not as theoretically well justified–
see Mainali et al. (2022, Science Advances)–but, in simulations, produces qualitatively similar results,
runs faster, and more consistently avoids problems like overdispersion. In this case, we are modeling p, the probability that both species co-occur at a given
site, given that at least one is present. Link function is logit. May be useful for pilot analyses.</p></dd>


<dt id="arg-olre">olre<a class="anchor" aria-label="anchor" href="#arg-olre"></a></dt>
<dd><p>Logical variable indicating whether to include observation-level random intercepts drawn from a
univariate normal distribution. Only relevant when family = 'fnchypg'. Defaults to TRUE, as these models
can often exhibit fit problems which may be mitigated by the random effects.</p></dd>


<dt id="arg-prior-intercept-scale">prior_intercept_scale<a class="anchor" aria-label="anchor" href="#arg-prior-intercept-scale"></a></dt>
<dd><p>Scale parameter for mean-zero Gaussian prior on the intercept term
for the linear predictor.</p></dd>


<dt id="arg-prior-betas-scale">prior_betas_scale<a class="anchor" aria-label="anchor" href="#arg-prior-betas-scale"></a></dt>
<dd><p>Scale parameter for mean-zero Gaussian priors on the coefficients of
fixed effect terms in the linear predictor.</p></dd>


<dt id="arg-prior-sigma-addeff-rate">prior_sigma_addeff_rate<a class="anchor" aria-label="anchor" href="#arg-prior-sigma-addeff-rate"></a></dt>
<dd><p>Rate parameter for exponential prior on the scale of the
species-level Gaussian random effects (i.e., "row and column effects").</p></dd>


<dt id="arg-prior-sigma-olre-rate">prior_sigma_olre_rate<a class="anchor" aria-label="anchor" href="#arg-prior-sigma-olre-rate"></a></dt>
<dd><p>Rate parameter for exponential prior on the scale of the
dyad-level Gaussian random effects.</p></dd>


<dt id="arg-prior-lambda-scale">prior_lambda_scale<a class="anchor" aria-label="anchor" href="#arg-prior-lambda-scale"></a></dt>
<dd><p>Scale parameter for mean-zero Gaussian prior on diagonal values of
Lambda, the matrix that determines how different species' values of the latent factors
interact in the linear predictor.</p></dd>


<dt id="arg-warmup">warmup<a class="anchor" aria-label="anchor" href="#arg-warmup"></a></dt>
<dd><p>Number of warmup iterations for Stan.</p></dd>


<dt id="arg-iter">iter<a class="anchor" aria-label="anchor" href="#arg-iter"></a></dt>
<dd><p>Number of posterior sampling iterations for Stan.</p></dd>


<dt id="arg-adapt-delta">adapt_delta<a class="anchor" aria-label="anchor" href="#arg-adapt-delta"></a></dt>
<dd><p>A parameter that tunes Stan's posterior sampling algorithm. Increasing closer to 1 can help avoid divergent transitions.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Object of class "compnet", which is a list containing the stanfit model object,
a named list of posterior samples for all model parameters, a data frame containing all
input variables for the model, a matrix of dyadic X variables, a matrix of X variables
pertaining to species A in each pair, a matrix of X variables pertaining to species B in
each pair, and–when relevant–a matrix
of means and standard deviations for the input trait data before centering and scaling.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function uses Stan, as accessed through the rstan package, to build a network
regression model of interspecific competitive niche differentiation in a Bayesian framework.
This function is designed to test the hypothesis that species are more likely to co-occur with
other species that are functionally dissimilar. Functional dissimilarity can be represented
directly by traits or by a proxy like phylogenetic distance. The core input data are a
species-by-site presence-absence matrix and one or more species-level traits
(e.g., plant leaf size) or pair-level traits (e.g., phylogenetic distance). Units of analysis
are species pairs. The response variable follows a binomial
distribution. The number of trials is the number of sites occupied by at least one
species in a pair, and the number of successes is the number of sites occupied by both species.
If species-level traits are used, each trait can be non-interacting
(i.e., there is no interaction term between species A's trait value and species B's),
interacting via a typical multiplicative term, or interacting via an absolute value difference
(i.e., "distance") term. The interaction terms are key to the core hypothesis. If competitive
niche differentiation is occurring, then the probability of co-occurrence is expected to
increase with trait or phylogenetic distance between species A and B, or with the product of
their trait values, if a multiplicative interaction is specified instead of a distance interaction.
Random effects are used to account for additive species-level dependencies and, optionally,
higher-order dependencies involving multiple species (e.g., "the enemy of my enemy is my friend").
Higher-order dependencies are modeled using a number of latent variable specified by "rank".
For more details on the random effects, see Hoff, P. (2021) Additive and multiplicative effects
network models. Stat. Sci. 36, 34–50.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">ex_presabs</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">ex_traits</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Quick demo run. Will prompt warnings.</span></span></span>
<span class="r-in"><span><span class="co"># Run with default warmup and iter for good posterior sampling.</span></span></span>
<span class="r-in"><span><span class="va">ex_compnet</span> <span class="op">&lt;-</span> <span class="fu">buildcompnet</span><span class="op">(</span>presabs<span class="op">=</span><span class="va">ex_presabs</span>,</span></span>
<span class="r-in"><span>spvars_dist_int<span class="op">=</span><span class="va">ex_traits</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ndtrait"</span><span class="op">)</span><span class="op">]</span>, warmup<span class="op">=</span><span class="fl">10</span>, iter<span class="op">=</span><span class="fl">20</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "You are currently running a compnet model with a Fisher's noncentral hypergeometric likelihood. This is the default option because there is strong theory supporting it. However, choosing a binomial likelihood (i.e., setting family='binomial') instead may result in a substantially faster run. This alternative option performs equally well in simulation-based testing. See https://kyle-rosenblad.github.io/compnet/ for more details"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SAMPLING FOR MODEL 'srm_fnchypg' NOW (CHAIN 1).</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Gradient evaluation took 0.00061 seconds</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 6.1 seconds.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Adjust your expectations accordingly!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: WARNING: No variance estimation is</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1:          performed for num_warmup &lt; 20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration:  1 / 20 [  5%]  (Warmup)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration:  2 / 20 [ 10%]  (Warmup)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration:  4 / 20 [ 20%]  (Warmup)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration:  6 / 20 [ 30%]  (Warmup)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration:  8 / 20 [ 40%]  (Warmup)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 10 / 20 [ 50%]  (Warmup)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 11 / 20 [ 55%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 12 / 20 [ 60%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 14 / 20 [ 70%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 16 / 20 [ 80%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 18 / 20 [ 90%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 20 / 20 [100%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1:  Elapsed Time: 0.327 seconds (Warm-up)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1:                0.225 seconds (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1:                0.552 seconds (Total)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: </span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>The largest R-hat is 2.12, indicating chains have not mixed.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> Running the chains for more iterations may help. See</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> https://mc-stan.org/misc/warnings.html#r-hat</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Bulk Effective Samples Size (ESS) is too low, indicating posterior means and medians may be unreliable.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> Running the chains for more iterations may help. See</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> https://mc-stan.org/misc/warnings.html#bulk-ess</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Tail Effective Samples Size (ESS) is too low, indicating posterior variances and tail quantiles may be unreliable.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> Running the chains for more iterations may help. See</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> https://mc-stan.org/misc/warnings.html#tail-ess</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "compnet uses Stan under the hood. You may see warnings from Stan alongside, \nthis message. To deal with any warnings Stan might issue, \nPlease see the links provided in Stan's output, as well as the compnet website:\nhttps://kyle-rosenblad.github.io/compnet/"</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kyle Rosenblad.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

